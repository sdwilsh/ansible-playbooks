---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

components:
  - ../../../components/minio
configMapGenerator:
  - name: alloy-config
    files:
      - configmap/config.alloy
    options:
      disableNameSuffixHash: true
helmCharts:
  - name: alloy
    namespace: alloy
    version: 0.11.0
    repo: https://grafana.github.io/helm-charts
    releaseName: alloy
    valuesFile: alloy-values.yml
  - name: loki
    namespace: monitoring
    version: 6.25.0
    repo: https://grafana.github.io/helm-charts
    releaseName: loki
    valuesFile: loki-values.yml
images:
  - name: quay.io/minio/minio
    newTag: latest@sha256:ed9be66eb5f2636c18289c34c3b725ddf57815f2777c77b5938543b78a44f144
namespace: monitoring
patches:
  - path: patches/minio/configure_storage.yml
    target:
      kind: StatefulSet
      name: minio-statefulset
  - path: patches/minio/set_root_credentials.yml
    target:
      kind: StatefulSet
      name: minio-statefulset
resources:
  - namespace.yml
  - ingress.yml
