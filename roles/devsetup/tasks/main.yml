---
# tasks file for devsetup
- name: Install Required Packages
  ansible.builtin.apt:
    name: "{{ item }}"
    state: present
  become: yes
  loop:
    - zsh
- name: Create sdwilsh group
  ansible.builtin.group:
    name: sdwilsh
    gid: 1000
    state: present
  become: yes
- name: Create sdwilsh user
  ansible.builtin.user:
    group: sdwilsh
    groups:
      - adm
      - dialout
      - cdrom
      - sudo
      - dip
      - plugdev
      - lxd
      - docker
    home: /home/sdwilsh
    name: sdwilsh
    shell: /bin/zsh
    state: present
    uid: 1000
  become: yes
- name: Download & Install Software
  ansible.builtin.include_tasks:
    file: download.yml
  loop:
    - executable: kubectl
      sha256: "https://dl.k8s.io/release/{{ kubectl_version }}/bin/linux/{{ deb_architecture[ansible_architecture] }}/kubectl.sha256"
      bin: https://dl.k8s.io/release/{{ kubectl_version }}/bin/linux/{{ deb_architecture[ansible_architecture] }}/kubectl
    - executable: starship
      sha256: "https://github.com/starship/starship/releases/download/{{ starship_version }}/starship-{{ ansible_architecture }}-unknown-linux-musl.tar.gz.sha256"
      targz: "https://github.com/starship/starship/releases/download/{{ starship_version }}/starship-{{ ansible_architecture }}-unknown-linux-musl.tar.gz"
    - executable: virtctl
      bin: "https://github.com/kubevirt/kubevirt/releases/download/{{ virtctl_version }}/virtctl-{{ virtctl_version }}-linux-{{ deb_architecture[ansible_architecture] }}"
  vars:
    deb_architecture:
      x86_64: amd64
    # renovate: datasource=github-releases depName=kubernetes/kubernetes
    kubectl_version: v1.28.3
    # renovate: datasource=github-releases depName=starship/starship
    starship_version: v1.16.0
    # renovate: datasource=github-releases depName=kubevirt/kubevirt
    virtctl_version: v1.1.0

- import_tasks: shell.yml
