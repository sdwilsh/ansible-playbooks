---

common__zfs_dataset_keys:
  mariadb:
    mariadb-data:
      key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33366239646466363436623632323831616130303737623065616234643030343338653031643238
          3236346635383937366434353034323338343934306330360a626138616638303530366231316439
          61653362636262343633353439303137363262656336323261376466323663306632653630656337
          3963383436333964310a393330303633346163376537306632363735343734643831346438373635
          62383166653639353038656139616632643430326633656664326661373666633339343336633635
          38313630383566333931663237373065353932666236653861326162383363393866316331616131
          62386366313966646132323837656430326266333230646632653332343431303035313362336534
          66653465323963663961
    mariadb-logs:
      key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          39633366643964383631346136303036666539306130646438356634303633316637623732316663
          3034393835326365666464646266626264613865363330380a376133656133336262343734633064
          30386463336339356639643663326637633864366639663263346130303230356232373866373730
          3534383438383865340a633732363435313438343130313465303764656264333964393761343237
          36663636323863643666363766396162636336323338383630383238663331636630303731346234
          65323238353433383665383666366263323931316466653763326530373861663262373365323566
          35663131363662363431666134303164663539633231613031613337663661636136633733323365
          38353661636162393537

# mrlesmithjr.zfs
zfs_create_pools: yes
zfs_create_filesystems: yes
zfs_enable_auto_snapshots: no # Snapshots managed by sanoid
zfs_filesystems:
  - name: mariadb-data
    encryption: aes-256-gcm
    keyformat: hex
    keylocation: file:///usr/local/etc/zfs/keys/mariadb/datasets/mariadb-data
    mountpoint: /var/lib/mysql/data
    pool: mariadb
    recordsize: 16K
    state: present
  - name: mariadb-logs
    encryption: aes-256-gcm
    keyformat: hex
    keylocation: file:///usr/local/etc/zfs/keys/mariadb/datasets/mariadb-logs
    mountpoint: /var/lib/mysql/logs
    pool: mariadb
    state: present
zfs_pools:
  - name: mariadb
    action: create
    atime: off
    compression: zstd
    devices:
      - /dev/disk/by-path/pci-0000:02:00.0-scsi-0:0:1:0
    state: present
    type: basic
