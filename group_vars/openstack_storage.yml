---
common__ethernet_interface_bridges:
  br-mgmt:
    ports:
      - "bond0.10"
  br-storage:
    ports:
      - "bond0.11"
    # 10.11.0.x/24, where x is whatever the management network ip is at the same spot.
    address: "{{ common__ip_addresses | ansible.utils.reduce_on_network('10.10.0.0/24') | first | ansible.utils.ipmath(65536) }}/24"
common__ethernet_interface_vlans:
  bond0.10:
  bond0.11:

openstack_ansible_deploy__storage_host_container_vars:
  cinder_backends:
    cinder_default_availability_zone: "cinderAZ_1"
    cinder_storage_availability_zone: "cinderAZ_1"
    limit_container_types: "cinder_volume"
    lvm:
      volume_backend_name: "LVM_iSCSI"
      volume_driver: "cinder.volume.drivers.lvm.LVMVolumeDriver"
      volume_group: "cinder-volume"
      # br-storage address
      iscsi_ip_address: "{{ common__ip_addresses | ansible.utils.reduce_on_network('10.10.0.0/24') | first | ansible.utils.ipmath(65536) }}"

# mrlesmithjr.manage-lvm
lvm_groups:
  - vgname: "cinder-volume"
    disks:
      - "/dev/zvol/openstack/cinder"
    create: yes
    lvnames:
      - None
manage_lvm: yes

# mrlesmithjr.zfs
zfs_create_pools: yes
zfs_create_volumes: yes
zfs_volumes:
  - name: "cinder"
    pool: "openstack"
    volsize: "400GiB"
    state: "present"
    encryption: "aes-128-ccm"
    keylocation: "file:///usr/local/etc/zfs/keys/openstack/cinder"
    keyformat: "hex"
